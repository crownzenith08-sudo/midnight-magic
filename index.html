<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Midnight Magic</title>

<!-- Google Font for elegant cursive -->
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  height: 100vh;
  background: linear-gradient(#0b1d2a, #000);
  font-family: 'Great Vibes', cursive;
  color: gold;
  overflow: hidden;
}

/* -------- BEFORE MIDNIGHT -------- */
#countdownPage {
  position: absolute;
  inset: 0;
  background: url("countdown.jpg") center/cover no-repeat;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
}

#timer {
  font-size: 60px;
  text-shadow: 0 0 20px gold;
}

/* -------- AFTER MIDNIGHT -------- */
#revealPage {
  display: none;
  position: absolute;
  inset: 0;
  background: url("reveal.jpg") center/cover no-repeat;
  text-align: center;
}

/* Blur effect later */
.blur {
  filter: blur(4px);
}

/* Title */
h1 {
  margin-top: 60px;
  font-size: 72px;
  text-shadow: 0 0 30px gold;
}

/* Letter */
.letter {
  position: absolute;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(30, 20, 5, 0.9);
  border: 2px solid gold;
  padding: 20px 30px;
  border-radius: 12px;
  cursor: pointer;
  box-shadow: 0 0 20px gold;
}

.letter::after {
  content: "ðŸ“œ Tap to open the letter";
  display: block;
  font-size: 22px;
  margin-top: 8px;
}

/* Open letter */
.letter-open {
  position: fixed;
  inset: 10%;
  background: 
  linear-gradient(rgba(15,10,5,0.85), rgba(15,10,5,0.85)),
  url("final.jpg") center/cover no-repeat;
  border: 3px solid gold;
  padding: 30px;
  font-size: 22px;
  line-height: 2.3;
  color: #f5e6b8;
  display: none;
  overflow-y: auto;
  box-shadow: 0 0 40px gold;
}

/* Golden text after voice */
#finalText {
  display: none;
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 60px;
  color: gold;
  text-shadow: 0 0 25px gold;
}

/* Fireworks canvas */
canvas {
  position: absolute;
  inset: 0;
  pointer-events: none;
}
</style>
</head>

<body>

<!-- BEFORE MIDNIGHT -->
<div id="countdownPage">
  <div id="timer"></div>
  <div id="magicText">Magic awaits you âœ¨</div>
</div>

<!-- AFTER MIDNIGHT -->
<div id="revealPage">
  <canvas id="fireworks"></canvas>
  <h1>âœ¨ Happy New Year Annie âœ¨</h1>

  <div class="letter" onclick="openLetter()"></div>

  <div class="letter-open" id="letterContent">
    My Dear Annie,<br><br>

    In a world that moves too fast each day,<br>
    you're the calm peace that always stays.<br>
    Not extravagantly loud, neither too forced,<br>
    just always there,<br>
    between every lore.<br><br>

    You know my chaos, my messy side,<br>
    quiet â€” always wondering how,<br>
    because I never shared those messy sides.<br>
    You were just a deep explorer,<br>
    who knew it all like my childhood fairy tale.<br><br>

    Wellâ€¦ still you stayed,<br>
    knowing that I am just a worthless human life.<br>
    And being you among billions of people,<br>
    thatâ€™s how I know,<br>
    you are the one.<br><br>

    Through random talks and late-night fun,<br>
    those silly inside jokes that only we outturn.<br>
    Whenever my life becomes a well of giving up,<br>
    you always came up â€” being the most daring,<br>
    always claiming that the well is mine first.<br><br>

    Well, I like that about you,<br>
    and I always do.<br><br>

    No promises carved in stone or time,<br>
    just a story that feels pure and fine.<br><br>

    At the end,<br>
    if life says you are just the first page of my life,<br>
    then I would love tearing up the rest of the pages,<br>
    â€™cause my book would still look fine.
  </div>

  <div id="finalText">donâ€™t forget me</div>
</div>

<!-- Hogwarts-style background music (placeholder) -->
<audio id="bgMusic">
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_2f3bba1b32.mp3">
</audio>

<script>
/* -------- COUNTDOWN -------- */
const target = new Date();
target.setHours(24,0,0,0);

const timer = document.getElementById("timer");
const countdownPage = document.getElementById("countdownPage");
const revealPage = document.getElementById("revealPage");

setInterval(() => {
  const now = new Date();
  const diff = target - now;
  if (diff <= 0) {
    countdownPage.style.display = "none";
    revealPage.style.display = "block";
    startFireworks();
  } else {
    const h = Math.floor(diff/3600000);
    const m = Math.floor(diff/60000)%60;
    const s = Math.floor(diff/1000)%60;
    timer.innerText = `${h}h ${m}m ${s}s`;
  }
}, 1000);

/* -------- MUSIC ON FIRST TAP -------- */
document.body.addEventListener("click", () => {
  document.getElementById("bgMusic").play();
}, { once: true });

/* -------- LETTER OPEN -------- */
function openLetter() {
  document.getElementById("letterContent").style.display = "block";

  setTimeout(() => {
    speakMagic();
  }, 15000);
}

/* -------- VOICE -------- */
function speakMagic() {
  const msg = new SpeechSynthesisUtterance(
    "May you get the best year, my lady."
  );
  msg.rate = 0.85;
  msg.pitch = 0.9;
  speechSynthesis.speak(msg);

  msg.onend = () => {
    revealPage.classList.add("blur");
    document.getElementById("finalText").style.display = "flex";
  };
}

/* -------- GOLD FIREWORKS -------- */
function startFireworks() {
  const canvas = document.getElementById("fireworks");
  const ctx = canvas.getContext("2d");
  canvas.width = innerWidth;
  canvas.height = innerHeight;

  const colors = ["#ffd700", "#f5c542", "#e6b800"];

  function firework() {
    const x = Math.random() * canvas.width;
    let y = canvas.height;
    const targetY = Math.random() * canvas.height/2;
    const color = colors[Math.floor(Math.random()*colors.length)];

    const interval = setInterval(() => {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      y -= 15;
      ctx.fillStyle = color;
      ctx.beginPath();
      ctx.arc(x,y,3,0,Math.PI*2);
      ctx.fill();

      if (y <= targetY) {
        clearInterval(interval);
        for (let i=0;i<40;i++) {
          ctx.beginPath();
          ctx.arc(x + Math.random()*80-40, y + Math.random()*80-40, 2, 0, Math.PI*2);
          ctx.fill();
        }
      }
    },30);
  }

  setInterval(firework, 800);
}
</script>

</body>
</html>